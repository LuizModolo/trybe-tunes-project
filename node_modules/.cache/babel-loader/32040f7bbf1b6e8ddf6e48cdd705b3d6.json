{"ast":null,"code":"import _regeneratorRuntime from\"/Users/luizmodolo/trybe/projetos_web/trybe-tunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/luizmodolo/trybe/projetos_web/trybe-tunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/luizmodolo/trybe/projetos_web/trybe-tunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/luizmodolo/trybe/projetos_web/trybe-tunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/luizmodolo/trybe/projetos_web/trybe-tunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/luizmodolo/trybe/projetos_web/trybe-tunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Header from'../components/Header';import Loading from'../components/Loading';import MusicCard from'../components/MusicCard';import getMusics from'../services/musicsAPI';import{addSong,getFavoriteSongs,removeSong}from'../services/favoriteSongsAPI';import'./album.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Album=/*#__PURE__*/function(_Component){_inherits(Album,_Component);var _super=_createSuper(Album);function Album(){var _this;_classCallCheck(this,Album);_this=_super.call(this);_this.getMusicAPI=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var params,albumSearchFull,albumSearch;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=_this.props.match.params;_context.next=3;return getMusics(params.id);case 3:albumSearchFull=_context.sent;albumSearch=albumSearchFull.slice(1);_this.setState({album:albumSearch,albumInfo:albumSearchFull[0],loading:false});case 6:case\"end\":return _context.stop();}}},_callee);}));_this.handleCheckbox=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref2){var target;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:target=_ref2.target;_this.setState({loading:true},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var album,objMusic;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:album=_this.state.album;objMusic=album.find(function(music){return Number(target.id)===Number(music.trackId);});if(!target.checked){_context2.next=8;break;}_context2.next=5;return addSong(objMusic);case 5:_this.setState(function(){return{loading:false};});_context2.next=11;break;case 8:_context2.next=10;return removeSong(objMusic);case 10:_this.setState(function(){return{loading:false};});case 11:_context2.next=13;return _this.handleSavedList();case 13:case\"end\":return _context2.stop();}}},_callee2);})));case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x){return _ref3.apply(this,arguments);};}();_this.musicIsFavorite=function(trackIdParam){var favoriteList=_this.state.favoriteList;var favMusicOk=favoriteList.some(function(favMusic){return favMusic.trackId===trackIdParam;});return favMusicOk;};_this.handleSavedList=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_this.setState({loading:true},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var savedList;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return getFavoriteSongs();case 2:savedList=_context4.sent;_this.setState({loading:false,favoriteList:savedList});case 4:case\"end\":return _context4.stop();}}},_callee4);})));case 1:case\"end\":return _context5.stop();}}},_callee5);}));_this.state={album:[],albumInfo:{},loading:true,favoriteList:[]};return _this;}_createClass(Album,[{key:\"componentDidMount\",value:function componentDidMount(){this.getMusicAPI();this.handleSavedList();}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,loading=_this$state.loading,album=_this$state.album,albumInfo=_this$state.albumInfo;return/*#__PURE__*/_jsxs(\"div\",{\"data-testid\":\"page-album\",children:[/*#__PURE__*/_jsx(Header,{}),loading?/*#__PURE__*/_jsx(Loading,{}):/*#__PURE__*/_jsxs(\"div\",{className:\"main-album\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"album-cart2\",children:[/*#__PURE__*/_jsx(\"img\",{src:albumInfo.artworkUrl100,alt:albumInfo.collectionName}),/*#__PURE__*/_jsx(\"h1\",{\"data-testid\":\"album-name\",children:albumInfo.collectionName}),/*#__PURE__*/_jsx(\"h3\",{\"data-testid\":\"artist-name\",children:albumInfo.artistName})]}),/*#__PURE__*/_jsx(\"div\",{className:\"music-album-list\",children:album.map(function(music){return/*#__PURE__*/_jsx(MusicCard,{music:music,funcFavSong:_this2.handleCheckbox,checkIsFav:_this2.musicIsFavorite(music.trackId)},music.trackId);})})]})]});}}]);return Album;}(Component);export default Album;","map":{"version":3,"sources":["/Users/luizmodolo/trybe/projetos_web/trybe-tunes/src/pages/Album.jsx"],"names":["React","Component","Header","Loading","MusicCard","getMusics","addSong","getFavoriteSongs","removeSong","Album","getMusicAPI","params","props","match","id","albumSearchFull","albumSearch","slice","setState","album","albumInfo","loading","handleCheckbox","target","state","objMusic","find","music","Number","trackId","checked","handleSavedList","musicIsFavorite","trackIdParam","favoriteList","favMusicOk","some","favMusic","savedList","artworkUrl100","collectionName","artistName","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Header from '../components/Header';\nimport Loading from '../components/Loading';\nimport MusicCard from '../components/MusicCard';\nimport getMusics from '../services/musicsAPI';\nimport { addSong, getFavoriteSongs, removeSong } from '../services/favoriteSongsAPI';\nimport './album.css';\n\nclass Album extends Component {\n  constructor() {\n    super();\n\n    this.state = {\n      album: [],\n      albumInfo: {},\n      loading: true,\n      favoriteList: [],\n    };\n  }\n\n  componentDidMount() {\n    this.getMusicAPI();\n    this.handleSavedList();\n  }\n\n  getMusicAPI = async () => {\n    const { match: { params } } = this.props;\n    const albumSearchFull = await getMusics(params.id);\n    const albumSearch = albumSearchFull.slice(1);\n    this.setState({\n      album: albumSearch,\n      albumInfo: albumSearchFull[0],\n      loading: false,\n    });\n  };\n\n  handleCheckbox = async ({ target }) => {\n    this.setState(\n      { loading: true },\n      async () => {\n        const { album } = this.state;\n        const objMusic = album\n          .find((music) => Number(target.id) === Number(music.trackId));\n        if (target.checked) {\n          await addSong(objMusic);\n          this.setState(() => ({\n            loading: false,\n          }));\n        } else {\n          await removeSong(objMusic);\n          this.setState(() => ({\n            loading: false,\n          }));\n        }\n        await this.handleSavedList();\n      },\n    );\n  }\n\n  musicIsFavorite = (trackIdParam) => {\n    const { favoriteList } = this.state;\n    const favMusicOk = favoriteList.some((favMusic) => favMusic.trackId === trackIdParam);\n    return favMusicOk;\n  }\n\n  handleSavedList = async () => {\n    this.setState(\n      { loading: true },\n      async () => {\n        const savedList = await getFavoriteSongs();\n        this.setState(({\n          loading: false,\n          favoriteList: savedList,\n        }));\n      },\n    );\n  }\n\n  render() {\n    const { loading, album, albumInfo } = this.state;\n    return (\n      <div data-testid=\"page-album\">\n        <Header />\n        {loading ? <Loading /> : (\n          <div className='main-album'>\n            <div className='album-cart2'>\n              <img src={ albumInfo.artworkUrl100 } alt={ albumInfo.collectionName } />\n              <h1 data-testid=\"album-name\">{albumInfo.collectionName}</h1>\n              <h3 data-testid=\"artist-name\">{albumInfo.artistName}</h3>\n            </div>\n            <div className='music-album-list'>\n              {album.map((music) => (<MusicCard\n                key={ music.trackId }\n                music={ music }\n                funcFavSong={ this.handleCheckbox }\n                checkIsFav={ this.musicIsFavorite(music.trackId) }\n              />))}\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nAlbum.propTypes = {\n  id: PropTypes.string.isRequired,\n  match: PropTypes.objectOf(PropTypes.object).isRequired,\n  params: PropTypes.objectOf(PropTypes.object).isRequired,\n};\n\nexport default Album;\n"]},"metadata":{},"sourceType":"module"}